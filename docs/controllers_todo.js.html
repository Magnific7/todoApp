<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: controllers/todo.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: controllers/todo.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import express from 'express'
import Todo from '../models/Todo.js'
import User from '../models/User.js'

/**
 * class to create a todo object
 */
class Todo_ {

  /**
   * @property {Function} getTodos Getting all todos
   * @returns {todos}
   */
  async getTodos(req, res) {
    try {
      
      const todos = await Todo.find({user: req.user.id})

      if(! todos){
        res.status(404).send({
          status: 404,
          message: ' No todos found'
        })
      }
      
      return res.status(200).send({
        todos
      })
    } catch (error) {
      console.log(error)
      res.status(500).send(error);
    }
  }
  /**
   * @property {Function} getOneTodo Getting one todo item
   * @returns {todo}
   */

  async getOneTodo(req,res){
    try {
      const todo = await Todo.findById(req.params.id)
      if(todo){
        if(todo.user.toString() === req.user.id){
          return res.status(200).send(todo);
        }else{
          return res.status(403).send({
            status: 403,
            message: 'unauthorized access'
          })
        }
        
      }else{
        return res.status(404).send({
          message: 'Todo not found'
        })
      }
    } catch (error) {
      console.log(error);
      return res.status(500).send({
        status: 500,
        message: 'server error'
      })
    }
  }

  /**
   * @property {Function} createTodo creating one todo item
   * @returns {todo}
   */

  async createTodo(req, res) {
    try {
      const {title, description, priority} = req.body;
      const todo = await Todo.create({
        title,
        description,
        priority,
        user: req.user.id
      })

      return res.status(201).send({
        todo,
        message:'Todo created'
      })   
        
    } catch (error) {
      console.log(error);
      return res.status(500).send(error);
    }
  }

  /**
   * @property {Function} updateTodo updating one todo item
   * @returns {todo}
   */
  async updateTodo(req,res){
    try {
      const todo = await Todo.findById(req.params.id);
      if(!todo){
        return res.status(404).send({
          status: 404,
          message: 'The resource you want to update does not exist'
        })
      }

      if(req.user.id === todo.user.toString()){
        Object.assign(todo, req.body);
        todo.save();
        res.status(200).send({
          status: 200,
          message: 'Todo updated'
        })
      }else{
        res.status(403).send({
          error: 'User not authorized'
        })
      }
      
      
    } catch (error) {
      res.status(500).send({
        status: 500,
        message:'server error'
      })
    }
  }

  /**
   * @property {Function} deleteTodo Getting one todo item
   * @returns {message}
   */
  async deleteTodo(req,res){
    try {
      const todo = await Todo.findById(req.params.id);
      if(!todo){
        return res.status(404).send({
          status: 404,
          message: 'The ressource you want to delete does not exist'
        })
      } 
      
      if(req.user.id === todo.user.toString()){
        await todo.remove();
         return res.status(200).send({
          status: 200,
          message: 'Todo is deleted'
        })
      }else{
        res.status(403).send({
          status: 403,
          message: 'Not authorized'
        })
      }
      
     
    } catch (error) {
      res.status(500).send(error)
    }
  }

 }

export default new Todo_();</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Todo App</a></h2><h3>Classes</h3><ul><li><a href="module.exports.html">exports</a></li><li><a href="Todo_.html">Todo_</a></li></ul><h3>Global</h3><ul><li><a href="global.html#comparePassword">comparePassword</a></li><li><a href="global.html#jwtToken">jwtToken</a></li><li><a href="global.html#signIn">signIn</a></li><li><a href="global.html#signUp">signUp</a></li><li><a href="global.html#verifyingToken">verifyingToken</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.6</a> on Tue Feb 23 2021 12:53:31 GMT+0200 (Central Africa Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
